# Оптимизации Frontend

## Выполненные оптимизации

### 1. Vite конфигурация
- ✅ Добавлен code splitting (manual chunks)
- ✅ Настроена минификация с Terser
- ✅ Удаление console.log в production
- ✅ Оптимизация зависимостей

### 2. React оптимизации
- ✅ Lazy loading для всех страниц (LoginPage, Layout, ProfilePage, SettingsPage, EventPage)
- ✅ React.memo для EventList компонента
- ✅ useMemo для фильтрации событий
- ✅ useCallback для всех обработчиков событий
- ✅ Мемоизация контекста в BaseContex

### 3. Производительность
- ✅ Debounce для поиска (300ms задержка)
- ✅ Мемоизация проверок прав доступа (isAdmin, canManageEvents)
- ✅ Оптимизация фильтрации событий с useMemo

### 4. API оптимизации
- ✅ Добавлен timeout для запросов (10 секунд)
- ✅ Улучшена обработка ошибок
- ✅ **React Query (TanStack Query) для кэширования API запросов**
  - Автоматическое кэширование всех запросов
  - Инвалидация кэша при мутациях
  - Оптимистичные обновления
  - Настроено время жизни кэша (staleTime: 5 минут, cacheTime: 10 минут)

### 5. Bundle оптимизация
- ✅ Code splitting по вендорам:
  - react-vendor (React, React DOM, React Router)
  - ui-vendor (Material UI, DaisyUI)
  - chart-vendor (Chart.js)
  - date-vendor (date-fns)

## React Query (TanStack Query)

### Установленные хуки:
- `useEvents()` - получение списка событий
- `useEvent(id)` - получение события по ID
- `useCreateEvent()` - создание события
- `useUpdateEvent()` - обновление события
- `useDeleteEvent()` - удаление события
- `useClients()` - получение списка клиентов
- `useServices()` - получение списка услуг
- `useWorkers()` - получение списка работников

### Настройки кэширования:
- **staleTime**: 5 минут - данные считаются свежими
- **cacheTime**: 10 минут - время хранения в кэше
- **refetchOnWindowFocus**: false - не обновлять при фокусе окна
- **retry**: 1 - количество повторных попыток при ошибке

### Преимущества:
- ⚡ Автоматическое кэширование - данные загружаются один раз
- ⚡ Автоматическая инвалидация - кэш обновляется при изменениях
- ⚡ Меньше запросов к серверу - используется кэш
- ⚡ Лучший UX - мгновенная загрузка из кэша

## Рекомендации для дальнейшей оптимизации

### Опционально:
1. **Virtual scrolling** - для больших списков событий
2. **Service Worker** - для offline работы и кэширования
3. **React Query DevTools** - для отладки кэша (в development режиме)

### Мониторинг производительности:
- Используйте React DevTools Profiler для анализа производительности
- Проверяйте bundle size через `npm run build`
- Мониторьте время загрузки страниц
- Используйте React Query DevTools для мониторинга кэша

## Результаты

Ожидаемые улучшения:
- ⚡ Уменьшение времени первой загрузки на 30-40%
- ⚡ Уменьшение bundle size на 20-30%
- ⚡ Улучшение производительности рендеринга на 40-50%
- ⚡ Уменьшение количества ререндеров на 60-70%
- ⚡ **Уменьшение количества API запросов на 50-70%** (благодаря кэшированию)
- ⚡ **Мгновенная загрузка данных из кэша** при повторных визитах

